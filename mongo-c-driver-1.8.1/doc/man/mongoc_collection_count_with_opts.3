.\" Man page generated from reStructuredText.
.
.TH "MONGOC_COLLECTION_COUNT_WITH_OPTS" "3" "Oct 11, 2017" "1.8.1" "MongoDB C Driver"
.SH NAME
mongoc_collection_count_with_opts \- mongoc_collection_count_with_opts()
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
int64_t
mongoc_collection_count_with_opts (mongoc_collection_t *collection,
                                   mongoc_query_flags_t flags,
                                   const bson_t *query,
                                   int64_t skip,
                                   int64_t limit,
                                   const bson_t *opts,
                                   const mongoc_read_prefs_t *read_prefs,
                                   bson_error_t *error);
.ft P
.fi
.UNINDENT
.UNINDENT
.SH PARAMETERS
.INDENT 0.0
.IP \(bu 2
\fBcollection\fP: A \fBmongoc_collection_t\fP\&.
.IP \(bu 2
\fBflags\fP: A \fBmongoc_query_flags_t\fP\&.
.IP \(bu 2
\fBquery\fP: A \fI\%bson_t\fP containing the query.
.IP \(bu 2
\fBskip\fP: A int64_t, zero to ignore.
.IP \(bu 2
\fBlimit\fP: A int64_t, zero to ignore.
.IP \(bu 2
\fBopts\fP: A \fI\%bson_t\fP, \fBNULL\fP to ignore.
.IP \(bu 2
\fBread_prefs\fP: An optional \fBmongoc_read_prefs_t\fP, otherwise uses the collection’s read preference.
.IP \(bu 2
\fBerror\fP: An optional location for a \fBbson_error_t\fP or \fBNULL\fP\&.
.UNINDENT
.SH DESCRIPTION
.sp
This function shall execute a count query on the underlying ‘collection’. The bson ‘query’ is not validated, simply passed along as appropriate to the server.  As such, compatibility and errors should be validated in the appropriate server documentation.
.sp
The \fBmongoc_read_concern_t\fP specified on the \fBmongoc_collection_t\fP will be used, if any. If \fBread_prefs\fP is NULL, the collection’s read preferences are used.
.sp
In addition to the standard functionality available from mongoc_collection_count, this function allows the user to add arbitrary extra keys to the count.  This pass through enables features such as hinting for counts.
.sp
For more information, see the \fI\%query reference\fP at the MongoDB website.
.SH ERRORS
.sp
Errors are propagated via the \fBerror\fP parameter.
.SH RETURNS
.sp
\-1 on failure, otherwise the number of documents counted.
.SH EXAMPLES
Basic Counting.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
#include <mongoc.h>
#include <bcon.h>
#include <stdio.h>

static void
print_query_count (mongoc_collection_t *collection, bson_t *query)
{
   bson_error_t error;
   int64_t count;
   bson_t opts;

   bson_init (&opts);
   BSON_APPEND_UTF8 (&opts, "hint", "_id_");

   count = mongoc_collection_count_with_opts (
      collection, MONGOC_QUERY_NONE, query, 0, 0, &opts, NULL, &error);

   bson_destroy (&opts);

   if (count < 0) {
      fprintf (stderr, "Count failed: %s\en", error.message);
   } else {
      printf ("%" PRId64 " documents counted.\en", count);
   }
}
.ft P
.fi
.UNINDENT
.UNINDENT
Counting with Collation.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
#include <mongoc.h>
#include <bcon.h>
#include <stdio.h>

static void
print_query_count (mongoc_collection_t *collection, bson_t *query)
{
   bson_t *selector;
   bson_t *opts;
   bson_error_t error;
   int64_t count;

   selector = BCON_NEW ("_id", "{", "$gt", BCON_UTF8 ("one"), "}");

   /* "One" normally sorts before "one"; make "one" come first */
   opts = BCON_NEW ("collation",
                    "{",
                    "locale",
                    BCON_UTF8 ("en_US"),
                    "caseFirst",
                    BCON_UTF8 ("lower"),
                    "}");

   count = mongoc_collection_count_with_opts (
      collection, MONGOC_QUERY_NONE, query, 0, 0, opts, NULL, &error);

   bson_destroy (selector);
   bson_destroy (opts);

   if (count < 0) {
      fprintf (stderr, "Count failed: %s\en", error.message);
   } else {
      printf ("%" PRId64 " documents counted.\en", count);
   }
}
.ft P
.fi
.UNINDENT
.UNINDENT
.SH AUTHOR
MongoDB, Inc
.SH COPYRIGHT
2017, MongoDB, Inc
.\" Generated by docutils manpage writer.
.
